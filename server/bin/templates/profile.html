<!doctype html>
<html lang="en">
<head>
  <title>Profile - Death Clock</title>
  <!-- defaults -->
  {% include 'defaultHead.html' %}
  <!-- Custom CSS-->
  <link href="/static/css/custom/profile.css" rel="stylesheet" />
  <!-- Custom JavaScript-->
  <script type="text/javascript" src="/static/js/custom/profile.js"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-12">
        <!-- Nav -->
        {% include 'menu.html' %}
        <!-- End Nav -->
        <!-- Content -->
        <div>
          <!-- Status -->
          <div id="status"> </div>
          <div class="row">
            <div id="left-panel" class="col-xs-4">
              <!-- Profile info -->
              <table class="table table-striped table-hover table-bordered profile-info">
                <tr><td>E-mail:                         </td><td>{{user.user.email}}                                         </td></tr>
                <tr><td>Joined:                         </td><td>{{user.user.joinTime|fromUTC}}                              </td></tr>
                <tr><td>Ping reminder:                  </td><td>as of {{user.user.warnDate|fromUTC}}                        </td></tr>
                <tr><td>Marked dead:                    </td><td>as of {{user.user.deathDate|fromUTC}}                       </td></tr>
                <tr><td>Warn me when inactive for:      </td><td><span id="warn">{{user.user.defaultWarnTime}}</span> day(s) </td></tr>
                <tr><td>Mark me dead when inactive for: </td><td><span id="dead">{{user.user.defaultExtension}}</span> day(s)</td></tr>
              </table>

              <!-- Password stuff -->
              <table class="table table-striped table-hover table-bordered profile-info">
                <tr><td>Current password:    </td><td><input id="passwd"        type="password"></input></td></tr>
                <tr><td>New password:        </td><td><input id="new_passwd"    type="password"></input></td></tr>
                <tr><td>Repeat new password: </td><td><input id="repeat_passwd" type="password"></input></td></tr>
                <tr><td colspan=2> <button id="change_pass">Change password</button> </td><tr>
              </table>
            </div>

            <div id='right-panel'class='col-xs-8'>
              <table id="actions" class="table table-striped table-hover table-bordered table-condensed">
                <thead>
                  <tr><td>Platform</td>
                      <td>To</td> 
                      <td>Username</td>
                      <td>Message</td>
                      <td>Actions</td></tr>
                </thead>
                <tbody>
                  {% for a in actions %}
                    {% if a.username %} {% set uname = a.username %}
                    {% else %} {% set uname = user.user.email %}
                    {% endif%}
                    {% if uname|length > 13 %} {% set uname = uname[:10] + "..."%}
                    {% endif %}
                    {% if a.message != None %} {% set mess = "glyphicon glyphicon-star"%}
                    {% else %} {% set mess = ""%}
                    {% endif %}
                    <tr id="action-{{loop.index}}">
                      <td>{{a.action}}</td>
                      <td>{{a.target}}</td>
                      <td>{{uname[:10]}}</td>
                      <td><div rel="tooltip" title="{{a.message}}">
                          <span class="{{mess}}"></span></div></td>
                      <td><span id="edit-{{loop.index}}"   title="edit"   class="glyphicon glyphicon-edit" data-toggle="modal" data-target="#editmodal"></span>
                          <span id="remove-{{loop.index}}" title="remove" class="glyphicon glyphicon-remove"></span></td></tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
          <!-- edit modal -->
          <div class="modal fade" id="editmodal" role="dialog">
            <div class="modal-dialog modal-sm">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class=modal-title>Edit Action</h4>
                </div>
                <div class="modal-body">
                  <table>
                    <tr><td>Method: </td><td>
                      <select id="method">
                        <option value="xmpp">xmpp</option>
                        <option value="irc" >irc </option>
                        <option value="mail">mail</option>
                      </select></td></tr>
                    <tr><td>To:     </td><td><input    id="target"   type="text"></input></td></tr>
                    <tr><td>Sent as:</td><td><input    id="username" type="text"></input></td></tr>
                    <tr><td>Message:</td><td><textarea id="message"></textarea></td></tr>
                  </table>
                  <button id="save">Save</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- end content -->
      </div>
    </div>
  </div>
</body>
</html>
